# Rate Limiting Configuration for Linux Tutorial CMS
# This file should be included in the main nginx.conf in the http {} block
# Include with: include /etc/nginx/conf.d/rate-limiting.conf;

# =============================================================================
# RATE LIMITING ZONES
# =============================================================================

# General API rate limiting: 10 requests per second
# The zone stores 10MB of IP addresses (~160,000 unique IPs)
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;

# Login endpoint rate limiting: 5 requests per minute (stricter for auth endpoints)
limit_req_zone $binary_remote_addr zone=login:10m rate=5r/m;

# Search endpoint rate limiting: 3 requests per second (prevents scraping)
limit_req_zone $binary_remote_addr zone=search:10m rate=3r/s;

# =============================================================================
# RATE LIMITING DEFAULTS
# =============================================================================

# Return 429 Too Many Requests when rate limit exceeded
limit_req_status 429;

# Log rate limiting events
limit_req_log_level warn;
